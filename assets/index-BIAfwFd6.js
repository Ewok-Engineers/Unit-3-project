(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const f=async()=>{const s=[];let e="https://swapi.dev/api/people/";try{for(;e;){const o=await fetch(e);if(!o.ok)throw new Error("Failed to fetch characters");const t=await o.json();await Promise.all(t.results.map(async r=>{const a=await g(r.homeworld);r.homeworld_name=a?a.name:"Unknown",r.starships_names=[],await Promise.all(r.starships.map(async n=>{const c=await w(n);c&&r.starships_names.push(c.name)})),s.push(r)})),e=t.next}}catch(o){console.error("Error fetching characters:",o)}return s},g=async s=>{try{const e=await fetch(s);if(!e.ok)throw new Error(`Failed to fetch homeworld from ${s}`);return e.json()}catch(e){return console.error("Error fetching homeworld:",e),null}},w=async s=>{try{const e=await fetch(s);if(!e.ok)throw new Error(`Failed to fetch Starship from ${s}`);return e.json()}catch(e){return console.error("Error fetching Starship:",e),null}},y=async()=>{const e=`https://swapi.dev/api/people/${C()}/`;try{const o=await fetch(e);if(!o.ok)throw new Error("Cannot fetch random ID from API");const t=await o.json();if(t.homeworld){const r=await g(t.homeworld);t.homeworld_name=r.name}else t.homeworld_name="Unknown";if(t.starships_names=[],t.starships.length>0)for(let r of t.starships){const a=await w(r);a&&t.starships_names.push(a.name)}else t.starships_names.push("None");return console.log(t),t}catch(o){return console.warn(o.message),null}},C=()=>Math.floor(Math.random()*83)+1,E=(s,e)=>{try{localStorage.setItem(s,JSON.stringify(e))}catch(o){console.error(`Error saving to local storage: ${o}`)}},L=s=>{try{const e=localStorage.getItem(s);return e?JSON.parse(e):null}catch(e){return console.error(`Error retrieving from local storage: ${e}`),null}},u=(s,e,o=!1)=>{const t=document.createElement("li");t.classList.add("grid-item");const r=document.createElement("img");r.src=`https://starwars-visualguide.com/assets/img/characters/${e.url.split("/")[5]}.jpg`,r.alt=e.name,r.classList.add("character-image");const a=document.createElement("p");a.textContent=`Name: ${e.name}`;const n=document.createElement("p");n.textContent=`Planet: ${e.homeworld_name}`;const c=document.createElement("p");c.textContent=`Starships: ${e.starships_names.join(", ")}`;const l=document.createElement("button");l.textContent="Click here for more info",l.classList.add("more-info-button"),l.addEventListener("click",()=>{t.classList.toggle("show-details")});const d=document.createElement("p");d.textContent=`Height: ${e.height}`,d.classList.add("hidden");const i=document.createElement("p");i.textContent=`Birth Year: ${e.birth_year}`,i.classList.add("hidden");const h=document.createElement("p");h.textContent=`Gender: ${e.gender.toUpperCase()}`,h.classList.add("hidden");const m=document.createElement("button");m.setAttribute("class","delete-btn"),m.textContent="Delete this Card",m.addEventListener("click",p),t.append(r,a,n,c,l,m,d,i,h),s.appendChild(t),l.addEventListener("click",()=>{d.classList.toggle("hidden"),i.classList.toggle("hidden"),h.classList.toggle("hidden")})},S=s=>{const e=document.getElementById("default-data-list");e.innerHTML="";const o=document.createElement("button");o.textContent="Learn about a random Star Wars Character",o.id="random-button",o.addEventListener("click",async()=>{const t=await y();t&&u(e,t)}),e.append(o);for(let t=0;t<3&&t<s.length;t++)u(e,s[t])},p=s=>{if(!s.target.matches(".delete-btn"))return;const e=s.target.closest("li");e.remove();const t=(JSON.parse(localStorage.getItem("searchedCharacters"))||[]).filter(r=>r.name!==e.querySelector("p").textContent.split(": ")[1]);localStorage.setItem("searchedCharacters",JSON.stringify(t))},v=async()=>{try{const s=await f();S(s)}catch(s){console.error("Failed to fetch and render characters:",s)}},I=async s=>{s.preventDefault();const e=s.target,o=e.querySelector("#search-input").value;if(!o){console.error("Please enter a character name");return}try{const r=(await f()).filter(a=>a.name.toLowerCase().includes(o.toLowerCase()));if(r.length>0){const a=document.getElementById("search-results-list");a.innerHTML="",r.forEach(async n=>{const c=await getHomeworld(n.homeworld);n.homeworld_name=c?c.name:"Unknown",n.starships_names=[];for(let d of n.starships){const i=await getStarShip(d);i&&n.starships_names.push(i.name)}u(a,n,!0);const l=L("searchedCharacters")||[];l.push(n),E("searchedCharacters",l)})}else console.error(`No characters found with name '${o}'`)}catch(t){console.error("Error fetching characters:",t)}e.reset()},$=async()=>{v();const s=JSON.parse(localStorage.getItem("searchedCharacters"))||[],e=document.getElementById("search-results-list");s.forEach(t=>{u(e,t,!0)}),document.querySelector("#search-form").addEventListener("submit",I),document.querySelector("#default-data-list").addEventListener("click",p),document.querySelector("#search-results-list").addEventListener("click",p)};$();
